<!DOCTYPE html>
<html>
	<head>
		<title>MockStarket</title>
		<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
        <link href="https://fonts.googleapis.com/css?family=Mukta+Vaani:300,400,500,700" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:100,300,400,500" rel="stylesheet">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
      rel="stylesheet">

        <link rel="stylesheet" href="css/main.css">

        <script src="scripts/utils.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"></script>
		<script src="scripts/dashboard.js"></script>

    </head>

	<body>

		<div class="app--container" id="app--container">
			
			<section id="modal--container">
				<div class="modal-card" v-if="showModal">
					<button v-on:click="closeModal()"><i class="material-icons">close</i></button>
					<div id="trade--view">
						<div class="modal-stock-id"> {{ stock.ticker_id }} </div>
						<div class="flex-grid--container no-padding">
							<div class="flex-column-50">
								<div id="calc-btn-buy" class="card calc-btn fill green no-buffer-top" v-on:click="setIsBuying(true)">BUY</div>
							</div>
							<div class="flex-column-50">
								<div id="calc-btn-sell" class="card calc-btn red no-buffer-top" v-on:click="setIsBuying(false)">SELL</div>
							</div>
							<div class="flex-column-50">
								<div class="card calc-btn" v-on:click="addAmount(1)">1</div>
							</div>
							<div class="flex-column-50">
								<div class="card calc-btn" v-on:click="addAmount(5)">5</div>
							</div>
							<div class="flex-column-50">
								<div class="card calc-btn" v-on:click="addAmount(25)">25</div>
							</div>
							<div class="flex-column-50">
								<div class="card calc-btn" v-on:click="addAmount(100)">100</div>
							</div>
							<div class="flex-column-50">
								<div class="card calc-btn" v-on:click="addAmount(0)">CUSTOM</div>
							</div>
							<div class="flex-column-50">
							  <div class="card calc-btn" v-on:click="determineMax()">MAX</div>
							</div>
							<div class="flex-column-100">
								<div class="card calc-btn clear" v-on:click="clearAmount()" data-val="0">CLEAR</div>
							</div>
							<div class="flex-column-100" style="padding: 0 15px;">
								<table class="table">
									<thead>

										<tr>
											<th>Price</th>
											<th>Amount</th>
											<th>Total</th>	
										</tr>
									</thead>
									<tbody>
										<tr>
											<td class='modal-stock-price'>${{ toPrice(stock.current_price) }}</td>
											<td>{{ buySellAmount }}</td>
											<td>${{ toPrice(buySellAmount * stock.current_price) }}</td>
										</tr>
									</tbody>
								</table>
							</div>
							
							<div class="flex-column-100">
								<div id="trade-request-submit" class="card calc-btn green no-buffer-top" v-on:click="submitTrade()">CONFIRM</div>
							</div>
							
					</div>
				</div>
			</section>
			
			<section id="side-menu--container">
				<div class="logo-mark">MOCKSTARKET</div>
				<!-- <div id="user-info-container" class="timer-container">
					<div class="level-circle">1</div>
					<p v-if="getCurrentUser(users)">{{ getCurrentUser(users) }}</p>
				</div> -->
				<div id="stats--view">
					<div class="stat-value blue"><i class="material-icons menu-icon">business</i>${{ toPrice(currUserPortfolio.net_worth) }}</div>
					<div class="stat-value green"><i class="material-icons menu-icon">local_atm</i>${{ toPrice(currUserPortfolio.wallet) }}</div>
					<div class="stat-value orange"><i class="material-icons menu-icon">trending_up</i>${{ toPrice(currUserPortfolio.investments) }}</div>
				</div>
				<ul id="nav">
					<li>
						<button v-on:click="nav" data-route="dashboard">
							<i class="material-icons menu-icon">business</i>
							<div class="menu-item-title">Dashboard</div>
							<i class="material-icons right-arrow">keyboard_arrow_right</i>
						</button>
					</li>
					<li>
						<button v-on:click="nav" data-route="business">
							<i class="material-icons menu-icon">store_mall_directory</i>
							<div class="menu-item-title">Business</div>
							<i class="material-icons right-arrow">keyboard_arrow_right</i>
						</button>
					</li>
					<li>
						<button v-on:click="nav" data-route="stocks">
							<i class="material-icons menu-icon">trending_up</i>
							<div class="menu-item-title">Stocks</div>
							<i class="material-icons right-arrow">keyboard_arrow_right</i>
						</button>
					</li>
					<li>
						<button v-on:click="nav" data-route="investors">
							<i class="material-icons menu-icon">account_box</i>
							<div class="menu-item-title">Investors</div>
							<i class="material-icons right-arrow">keyboard_arrow_right</i>
						</button>
					</li>
					<li>
						<button v-on:click="nav" data-route="futures">
							<i class="material-icons menu-icon">swap_horiz</i>
							<div class="menu-item-title">Futures</div>
							<i class="material-icons right-arrow">keyboard_arrow_right</i>
						</button>
					</li>
					<li>
						<button v-on:click="nav" data-route="perks">
							<i class="material-icons menu-icon">local_atm</i>
							<div class="menu-item-title">Store</div>
							<i class="material-icons right-arrow">keyboard_arrow_right</i>
						</button>
					</li>
					<li>
						<button class="debug-btn red" v-on:click="nav">
							<i class="material-icons menu-icon">build</i>
							<div class="menu-item-title">Debug</div>
							<i class="material-icons right-arrow">keyboard_arrow_right</i>
						</button>
					</li>
				</ul>
			</section>
			<section id="top-bar--container">
				<div class="current-view" id="current-view">Dashboard</div>
				<div class="account-settings-btn">
						<span></span>
						<span></span>
						<span></span>	
					</div>

				<div id="user-info-container" class="nav-list">
					<div class="username-text">{{ userDisplayName }}</div>
					
					
				
				</div>
				
				
				<div class="account-settings-menu--container">
					<i id="account-settings-menu-close-btn" class="material-icons">close</i>
					<ul>
						<li>
							<textarea id="newDisplayName"></textarea>
						</li>
						<li>
							<button id="changeDisplayName" v-on:click="changeDisplayName">Change Display Name</button>
						</li>
						<li>
							<button id="btn-logout" v-on:click="logout">Logout</button>
						</li>
					</ul>
				</div>
			</section>
			<section id="main-content--container" class="">
				<div class="view-container">
					<div id="dashboard--view" class="active view">
						<div class="flex-grid--container">
							<div class="flex-column-33">
								<div class="card small">
									<div class="stat-value blue">
										<i class="material-icons menu-icon">business</i>
										<div class="card-details">
											<div class="card-category">NETWORTH</div>
											<p><span class="small-money">$</span>{{ toPrice(currUserPortfolio.net_worth) }}</p>
										</div>
									</div>
								</div>
							</div>
							<div class="flex-column-33">
								<div class="card small">
									<div class="stat-value green">
										<i class="material-icons menu-icon">local_atm</i>
										<div class="card-details">
											<div class="card-category">CASH</div>
											<p><span class="small-money">$</span>{{ toPrice(currUserPortfolio.wallet) }}</p>
										</div>
									</div>
								</div>
							</div>
							<div class="flex-column-33">
								<div class="card small">
									<div class="stat-value orange">
										<i class="material-icons menu-icon">trending_up</i>
										<div class="card-details">
											<div class="card-category">INVESTMENTS</div>
											<p><span class="small-money">$</span>{{ toPrice(currUserPortfolio.investments) }}</p>
										</div>
									</div>
								</div>
							</div>
							<div class="flex-column-100">
								<div class="card stock-list">
									<table class="table">
										<thead>
									    	<tr>
										    	<th scope="col" style="text-align: left; padding-left: 25px;" v-on:click="sortCol('stock_ticker')">Stock</th>
										    	<th scope="col" style="padding-right: 25px;" v-on:click="sortCol('amount')">Amount Owned</th>
										    	<th scope="col" style="padding-right: 25px;" v-on:click="sortCol('stock_price')">Current Price</th>
										    	<th scope="col" style="padding-right: 25px;" v-on:click="sortCol('stock_value')">Value</th>
										    	<th scope="col" style="padding-right: 25px;" v-on:click="sortCol('stock_roi')" >R.O.I.</th>
										    </tr>
										</thead>
										<tbody>
											<tr class="clickable" v-for="stock in currUserStocks" :key='stock.uuid' v-bind:uuid="stock.uuid">
												<th class="stock-ticker-id" scope="row" v-bind:tid="stock.stock_ticker" style="line-height: 40px;">{{ stock.stock_ticker }}</th>
												<td class="stock-price" style="text-align: right; padding-right: 25px;">{{ stock.amount }}</td>
												<!-- Brennan these tds should use onclick idk how we have been implementing that -->
												<td class="price-alter stock-price" style="text-align: right; padding-right: 25px;">${{ toPrice(stock.stock_price) }}</td>
												<td class="price-alter stock-price" style="text-align: right; padding-right: 25px;">${{ toPrice(stock.stock_value) }}</td>
												<td class="stock-change" style="text-align: right; padding-right: 25px;">${{ toPrice(stock.stock_roi) }}</td>
												
											</tr>
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
					<div id="business--view" class="view">
						<div class="flex-grid--container">
							<div class="flex-column-100">
								<div class="card">
									<h1>BUSINESS</h1>
								</div>
							</div>
						</div>
					</div>
					<div id="stocks--view" class="view">
						<div class="flex-grid--container" id="stockSuperlatives">
							<div class="flex-column-33">
								<div class="card small">
									<div class="stat-value blue">
										<i class="material-icons menu-icon">business</i>
										<div class="card-details">
											<div class="card-category">MOST EXPENSIVE</div>
											<p>{{ highestStock }}</p>
										</div>
									</div>
								</div>
							</div>
							<div class="flex-column-33">
								<div class="card small">
									<div class="stat-value green">
										<i class="material-icons menu-icon">local_atm</i><div class="card-details">
											<div class="card-category">HIGHEST GROWTH</div>
											<p>{{ mostChange }}</p>
										</div>
									</div>
								</div>
							</div>
							<div class="flex-column-33">
								<div class="card small">
									<div class="stat-value orange">
										<i class="material-icons menu-icon">trending_up</i><div class="card-details">
											<div class="card-category">LEAST EXPENSIVE</div>
											<p>{{ lowestStock }}</p>
										</div>
									</div>
								</div>
							</div>
							<div class="flex-column-100">
								<div class="card stock-list">
									<div id="stock-list">
										<table class="table">
										  <thead>
											<tr>
											  <th scope="col" v-on:click="sortCol('ticker_id')" style="text-align: left; padding-left: 25px;">Stock <i class="material-icons stock">arrow_drop_down</i></th>
											  <th scope="col" v-on:click="sortCol('open_shares')">Open Shares <i class="material-icons open-shares">arrow_drop_down</i></th>
											  <th scope="col" v-on:click="sortCol('change')">Change <i class="material-icons change">arrow_drop_down</i></th>
											  <th scope="col" v-on:click="sortCol('current_price')" style="padding-right: 25px;">Cost <i class="material-icons cost">arrow_drop_down</i></th>
											</tr>
										  </thead>
										  <tbody>
											  <!-- https://vuejs.org/v2/guide/list.html :key is recommended in v.fors -->
											<tr class="clickable" v-for="stock in sortedStocks" :key='stock.uuid' v-bind:uuid="stock.uuid">
											  <th class="stock-ticker-id" scope="row" v-bind:tid="stock.ticker_id">
												  <div class="stock-ticker-id">{{ stock.ticker_id }}</div>
												  <div class="stock-display-name">{{ stock.name }}</div>
											  </th>
											  <td class="stock-open-shares">{{ stock.open_shares }}</td>
											  <td class="stock-change">
												  {{ toPrice(stock.change) }}
												  <i class="material-icons">arrow_drop_down</i>
											  </td>
											  <td class="stock-price" style="padding-right: 25px;">
											  ${{ toPrice(stock.current_price) }}</td>
											</tr>
										  </tbody>
										</table>
									</div>
								</div>
							</div>
						</div>
					</div>
					<!-- TODO: this tab collides with the sidebar -->
					<div id="investors--view" class="view">
						<div class="flex-grid--container">
							<div class="flex-column-100">
								<div class="card">
									<h1>INVESTORS</h1>
								</div>
							</div>
							<div class="flex-column-100" id="portfolio-list">
								<div>

									<!-- Needs to be some version of this -->
									<div class="card" v-for="investor in investors" :key="investor.uuid">

										<td>{{ investor.name }}</td>
								    	<td>Wallet: {{ toPrice(investor.wallet) }}</td>
								    	<td>Net Worth: {{ toPrice(investor.net_worth) }}</td>

										<!-- Needs to be some version of this -->
										<div v-for="stock in investor.stocks">

											<td>{{ stock.ticker_id }}</th>
									    	<td>{{ stock.amount }}</td>
									    	<td>{{ toPrice(stock.current_price) }}</td>
									    	<td>{{ toPrice(stock.value) }}</td>

										</div>
										<br><br>
									</div>

<!-- +
									<table class="table">
										<thead>
									    	<tr>
									    	  <th scope="col">Name</th>
									    	  <th scope="col">wallet</th>
									    	  <th scope="col">net worth</th>
									    	</tr>
										</thead>
										<tbody>
										    <tr class="investor" v-if="investors.length != 0" v-for="investor in investors" :key="investor.uuid">
										    	<td>{{ investor.name }}</td>
										    	<td>{{ investor.stocks }}</td>
										    	<td>{{ toPrice(investor.wallet) }}</td>
										    	<td>{{ toPrice(investor.net_worth) }}</td>
										    </tr>
										</tbody>
									</table>
 -->								
								</div>

								<investor-card
									v-for="investor in investors"
									:key="investor.uuid"
									v-bind:user_uuid="investor.user_uuid">
										
									</investor-card>
							</div>
						</div>
					</div>

					<!-- TODO: this tab collides with the sidebar -->
					<div id="futures--view" class="view">
						<div class="flex-grid--container">
							<div class="flex-column-100">
								<div class="card">
									<h1>FUTURES</h1>
								</div>
							</div>
						</div>
					</div>
					<!-- TODO: this tab collides with the sidebar -->
					<div id="store--view" class="view">
						<div class="flex-grid--container">
							<div class="flex-column-100">
								<div class="card">
									<h1>STORE</h1>
								</div>
							</div>
						</div>
					</div>
				</div>
			</section>
			<section id="chat-module--container" class="closed">
				<div class="chat-title-bar" v-bind:title="activeUsers()">
					<span>All Chat ({{ numActiveUsers }})</span>
					<button v-on:click="toggleChat()"></button>
				</div>

				<!-- 
					Make Chat resizable
					Make user's own messages show differently 
				-->
				<ul class="chat-message--list">
					
				</ul>
				<textarea id="chat-text-input" placeholder="Say anything..."></textarea>
			</section>
			<section id="debug-module--container" class="closed">
				<div class="debug-title-bar">
					<span>Server Log</span>
					<button></button>
				</div>

				<!-- 
					Make Chat resizable
					Make user's own messages show differently 
				-->
				<ul class="debug-message--list">
					
				</ul>
				
			</section>
		</div>
	</body>
	
</html>